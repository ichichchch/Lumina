<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Lumina.App.ViewModels"
             x:Class="Lumina.App.Views.AddServerPage"
             x:DataType="vm:AddServerViewModel">

    <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                  VerticalScrollBarVisibility="Auto">
        <StackPanel Spacing="24" Margin="32" MaxWidth="760" HorizontalAlignment="Center">

            <!-- Header -->
            <Grid ColumnDefinitions="Auto,*,Auto">
                <Button Grid.Column="0" 
                        Classes="Ghost"
                        Command="{Binding CancelCommand}"
                        VerticalAlignment="Center">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <PathIcon Data="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"
                                  Width="16" Height="16" />
                        <TextBlock Text="{DynamicResource AddServer_Back}" />
                    </StackPanel>
                </Button>
                
                <StackPanel Grid.Column="1" Spacing="8" Margin="24,0">
                    <TextBlock Text="{Binding PageTitle}" Classes="Display" />
                    <TextBlock Text="{Binding PageSubtitle}" Classes="Body" />
                </StackPanel>

                <Button Grid.Column="2" 
                        Classes="Primary"
                        Command="{Binding SaveCommand}"
                        IsEnabled="{Binding CanSave}"
                        VerticalAlignment="Top">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <PathIcon Data="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"
                                  Width="16" Height="16" />
                        <TextBlock Text="{DynamicResource AddServer_Save}" />
                    </StackPanel>
                </Button>
            </Grid>

            <!-- Validation Errors -->
            <Border Classes="Card" 
                    IsVisible="{Binding HasValidationErrors}"
                    Background="#331E293B"
                    BorderBrush="{StaticResource ErrorBrush}">
                <StackPanel Spacing="8">
                    <TextBlock Text="{DynamicResource AddServer_ErrorsTitle}" Classes="BodyStrong" 
                               Foreground="{StaticResource ErrorBrush}" />
                    <ItemsControl ItemsSource="{Binding ValidationErrors}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding}" Classes="Caption" />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </Border>

            <!-- Basic Info -->
            <Border Classes="Card">
                <StackPanel Spacing="16">
                    <TextBlock Text="{DynamicResource AddServer_BasicInfoTitle}" Classes="Title" />
                    
                    <StackPanel Spacing="8">
                        <TextBlock Text="{DynamicResource AddServer_ServerNameLabel}" Classes="Caption" />
                        <TextBox Classes="Lumina" 
                                 Text="{Binding Name}" 
                                 Watermark="{DynamicResource AddServer_ServerNameWatermark}" />
                    </StackPanel>

                    <StackPanel Spacing="8">
                        <TextBlock Text="{DynamicResource AddServer_LocationLabel}" Classes="Caption" />
                        <TextBox Classes="Lumina" 
                                 Text="{Binding Location}" 
                                 Watermark="{DynamicResource AddServer_LocationWatermark}" />
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Peer Configuration -->
            <Border Classes="Card">
                <StackPanel Spacing="16">
                    <TextBlock Text="{DynamicResource AddServer_PeerConfigTitle}" Classes="Title" />
                    
                    <StackPanel Spacing="8">
                        <TextBlock Text="{DynamicResource AddServer_EndpointLabel}" Classes="Caption" />
                        <TextBox Classes="Lumina" 
                                 Text="{Binding Endpoint}" 
                                 Watermark="{DynamicResource AddServer_EndpointWatermark}" />
                    </StackPanel>

                    <StackPanel Spacing="8">
                        <TextBlock Text="{DynamicResource AddServer_PublicKeyLabel}" Classes="Caption" />
                        <TextBox Classes="Lumina" 
                                 Text="{Binding PublicKey}" 
                                 Watermark="{DynamicResource AddServer_PublicKeyWatermark}" />
                    </StackPanel>

                    <StackPanel Spacing="8">
                        <TextBlock Text="{DynamicResource AddServer_PresharedKeyLabel}" Classes="Caption" />
                        <TextBox Classes="Lumina" 
                                 Text="{Binding PresharedKey}" 
                                 Watermark="{DynamicResource AddServer_PresharedKeyWatermark}" />
                    </StackPanel>

                    <StackPanel Spacing="8">
                        <TextBlock Text="{DynamicResource AddServer_AllowedIpsLabel}" Classes="Caption" />
                        <TextBox Classes="Lumina" 
                                 Text="{Binding AllowedIPs}" 
                                 Watermark="{DynamicResource AddServer_AllowedIpsWatermark}" />
                    </StackPanel>

                    <StackPanel Spacing="8">
                        <TextBlock Text="{DynamicResource AddServer_KeepaliveLabel}" Classes="Caption" />
                        <TextBox Classes="Lumina" 
                                 Text="{Binding PersistentKeepalive}" 
                                 Watermark="{DynamicResource AddServer_KeepaliveWatermark}" />
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Interface Configuration -->
            <Border Classes="Card">
                <StackPanel Spacing="16">
                    <TextBlock Text="{DynamicResource AddServer_InterfaceConfigTitle}" Classes="Title" />
                    
                    <Grid ColumnDefinitions="*,Auto">
                        <StackPanel Spacing="8">
                            <TextBlock Text="{DynamicResource AddServer_PrivateKeyLabel}" Classes="Caption" />
                            <TextBox Classes="Lumina" 
                                     Text="{Binding PrivateKey}" 
                                     Watermark="{DynamicResource AddServer_PrivateKeyWatermark}" />
                        </StackPanel>
                        <Button Grid.Column="1" 
                                Classes="Secondary"
                                Command="{Binding GenerateKeyPairCommand}"
                                VerticalAlignment="Bottom"
                                Margin="12,0,0,0">
                            <TextBlock Text="{DynamicResource AddServer_Generate}" />
                        </Button>
                    </Grid>

                    <StackPanel Spacing="8">
                        <TextBlock Text="{DynamicResource AddServer_DerivedPublicKeyLabel}" Classes="Caption" />
                        <TextBox Classes="Lumina"
                                 Text="{Binding DerivedPublicKey}"
                                 IsReadOnly="True"
                                 Watermark="{DynamicResource AddServer_DerivedPublicKeyWatermark}" />
                    </StackPanel>

                    <StackPanel Spacing="8">
                        <TextBlock Text="{DynamicResource AddServer_InterfaceAddressLabel}" Classes="Caption" />
                        <TextBox Classes="Lumina" 
                                 Text="{Binding InterfaceAddress}" 
                                 Watermark="{DynamicResource AddServer_InterfaceAddressWatermark}" />
                    </StackPanel>

                    <StackPanel Spacing="8">
                        <TextBlock Text="{DynamicResource AddServer_DnsServersLabel}" Classes="Caption" />
                        <TextBox Classes="Lumina" 
                                 Text="{Binding DnsServers}" 
                                 Watermark="{DynamicResource AddServer_DnsServersWatermark}" />
                    </StackPanel>
                </StackPanel>
            </Border>

        </StackPanel>
    </ScrollViewer>

</UserControl>

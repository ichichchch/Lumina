<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Lumina.App.ViewModels"
             x:Class="Lumina.App.Views.SettingsPage"
             x:DataType="vm:SettingsViewModel">

    <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                  VerticalScrollBarVisibility="Auto">
        <StackPanel Spacing="24" Margin="32" MaxWidth="760" HorizontalAlignment="Center">

            <!-- Header -->
            <Border Classes="Card" Padding="24">
                <StackPanel Spacing="6">
                    <TextBlock Text="{DynamicResource Settings_Title}" Classes="Display" />
                    <TextBlock Text="{DynamicResource Settings_Subtitle}" Classes="Body" />
                </StackPanel>
            </Border>

            <!-- General Settings -->
            <StackPanel Spacing="12">
                <TextBlock Text="{DynamicResource Settings_SectionGeneral}" Classes="StatLabel" />
                <Border Classes="Card">
                    <StackPanel Spacing="16" HorizontalAlignment="Stretch">
                        
                        <Grid ColumnDefinitions="*,12,Auto" HorizontalAlignment="Stretch" MinHeight="56">
                            <StackPanel>
                                <TextBlock Text="{DynamicResource Settings_AutoConnectTitle}" Classes="BodyStrong" MaxLines="1" TextTrimming="CharacterEllipsis" />
                                <TextBlock Text="{DynamicResource Settings_AutoConnectDesc}" Classes="Caption" TextWrapping="Wrap" MaxLines="2" TextTrimming="CharacterEllipsis" />
                            </StackPanel>
                            <ToggleSwitch Grid.Column="2"
                                          Classes="Lumina"
                                          IsChecked="{Binding AutoConnect}"
                                          AutomationProperties.Name="{DynamicResource Settings_AutoConnectTitle}"
                                          HorizontalAlignment="Right"
                                          VerticalAlignment="Center" />
                        </Grid>

                        <Border Height="1" Background="{DynamicResource BorderDefault}" />

                        <Grid ColumnDefinitions="*,12,Auto" HorizontalAlignment="Stretch" MinHeight="56">
                            <StackPanel>
                                <TextBlock Text="{DynamicResource Settings_StartWithWindowsTitle}" Classes="BodyStrong" MaxLines="1" TextTrimming="CharacterEllipsis" />
                                <TextBlock Text="{DynamicResource Settings_StartWithWindowsDesc}" Classes="Caption" TextWrapping="Wrap" MaxLines="2" TextTrimming="CharacterEllipsis" />
                            </StackPanel>
                            <ToggleSwitch Grid.Column="2"
                                          Classes="Lumina"
                                          IsChecked="{Binding StartOnBoot}"
                                          AutomationProperties.Name="{DynamicResource Settings_StartWithWindowsTitle}"
                                          HorizontalAlignment="Right"
                                          VerticalAlignment="Center" />
                        </Grid>

                        <Border Height="1" Background="{DynamicResource BorderDefault}" />

                        <Grid ColumnDefinitions="*,12,Auto" HorizontalAlignment="Stretch" MinHeight="56">
                            <StackPanel>
                                <TextBlock Text="{DynamicResource Settings_StartMinimizedTitle}" Classes="BodyStrong" MaxLines="1" TextTrimming="CharacterEllipsis" />
                                <TextBlock Text="{DynamicResource Settings_StartMinimizedDesc}" Classes="Caption" TextWrapping="Wrap" MaxLines="2" TextTrimming="CharacterEllipsis" />
                            </StackPanel>
                            <ToggleSwitch Grid.Column="2"
                                          Classes="Lumina"
                                          IsChecked="{Binding StartMinimized}"
                                          AutomationProperties.Name="{DynamicResource Settings_StartMinimizedTitle}"
                                          HorizontalAlignment="Right"
                                          VerticalAlignment="Center" />
                        </Grid>

                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- Security Settings -->
            <StackPanel Spacing="12">
                <TextBlock Text="{DynamicResource Settings_SectionSecurity}" Classes="StatLabel" />
                <Border Classes="Card">
                    <StackPanel Spacing="16" HorizontalAlignment="Stretch">
                        
                        <Grid ColumnDefinitions="*,12,Auto" HorizontalAlignment="Stretch" MinHeight="56">
                            <StackPanel>
                                <TextBlock Text="{DynamicResource Settings_KillSwitchTitle}" Classes="BodyStrong" MaxLines="1" TextTrimming="CharacterEllipsis" />
                                <TextBlock Text="{DynamicResource Settings_KillSwitchDesc}" 
                                           Classes="Caption"
                                           TextWrapping="Wrap"
                                           MaxLines="2"
                                           TextTrimming="CharacterEllipsis" />
                            </StackPanel>
                            <ToggleSwitch Grid.Column="2"
                                          Classes="Lumina"
                                          IsChecked="{Binding KillSwitch}"
                                          AutomationProperties.Name="{DynamicResource Settings_KillSwitchTitle}"
                                          HorizontalAlignment="Right"
                                          VerticalAlignment="Center" />
                        </Grid>

                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- Appearance Settings -->
            <StackPanel Spacing="12">
                <TextBlock Text="{DynamicResource Settings_SectionAppearance}" Classes="StatLabel" />
                <Border Classes="Card">
                    <Grid ColumnDefinitions="*,12,Auto" HorizontalAlignment="Stretch" MinHeight="56">
                        <StackPanel>
                            <TextBlock Text="{DynamicResource Settings_ThemeTitle}" Classes="BodyStrong" MaxLines="1" TextTrimming="CharacterEllipsis" />
                            <TextBlock Text="{DynamicResource Settings_ThemeDesc}" Classes="Caption" TextWrapping="Wrap" MaxLines="2" TextTrimming="CharacterEllipsis" />
                        </StackPanel>
                        <ComboBox Grid.Column="2"
                                  x:Name="ThemeComboBox"
                                  Classes="Lumina"
                                  SelectedIndex="{Binding SelectedThemeIndex}"
                                  MinWidth="160"
                                  MaxWidth="240"
                                  HorizontalAlignment="Right"
                                  VerticalAlignment="Center">
                            <ComboBoxItem Content="{DynamicResource Theme_Light}" />
                            <ComboBoxItem Content="{DynamicResource Theme_Dark}" />
                            <ComboBoxItem Content="{DynamicResource Theme_Auto}" />
                        </ComboBox>
                    </Grid>
                </Border>
            </StackPanel>

            <!-- Language Settings -->
            <StackPanel Spacing="12">
                <TextBlock Text="{DynamicResource Settings_SectionLanguage}" Classes="StatLabel" />
                <Border Classes="Card">
                    <Grid ColumnDefinitions="*,12,Auto" HorizontalAlignment="Stretch" MinHeight="56">
                        <StackPanel>
                            <TextBlock Text="{DynamicResource Settings_Language}" Classes="BodyStrong" MaxLines="1" TextTrimming="CharacterEllipsis" />
                            <TextBlock Text="{DynamicResource Settings_LanguageDesc}" Classes="Caption" TextWrapping="Wrap" MaxLines="2" TextTrimming="CharacterEllipsis" />
                        </StackPanel>
                        <ComboBox Grid.Column="2"
                                  x:Name="LanguageComboBox"
                                  Classes="Lumina"
                                  SelectedIndex="{Binding SelectedLanguageIndex}"
                                  MinWidth="160"
                                  MaxWidth="240"
                                  HorizontalAlignment="Right"
                                  VerticalAlignment="Center">
                            <ComboBoxItem Content="{DynamicResource Settings_LanguageAuto}" />
                            <ComboBoxItem Content="{DynamicResource Language_English}" />
                            <ComboBoxItem Content="{DynamicResource Language_ZhCn}" />
                        </ComboBox>
                    </Grid>
                </Border>
            </StackPanel>

            <!-- Advanced Settings -->
            <StackPanel Spacing="12">
                <TextBlock Text="{DynamicResource Settings_SectionAdvanced}" Classes="StatLabel" />
                <Border Classes="Card">
                    <StackPanel Spacing="16">
                        
                        <Button Classes="Secondary" HorizontalAlignment="Left"
                                Command="{Binding ExportLogsCommand}">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <PathIcon Data="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"
                                          Width="16" Height="16" />
                                <TextBlock Text="{DynamicResource Settings_ExportLogs}" />
                            </StackPanel>
                        </Button>

                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- About Section -->
            <StackPanel Spacing="12">
                <TextBlock Text="{DynamicResource Settings_SectionAbout}" Classes="StatLabel" />
                <Border Classes="Card">
                    <StackPanel Spacing="16">
                        
                        <Grid ColumnDefinitions="*,12,Auto" HorizontalAlignment="Stretch" MinHeight="48">
                            <TextBlock Text="{DynamicResource Settings_LuminaVersion}" Classes="BodyStrong" />
                            <TextBlock Grid.Column="2"
                                       Text="{Binding AppVersion}" 
                                       Classes="Body"
                                       HorizontalAlignment="Right" />
                        </Grid>

                        <Border Height="1" Background="{DynamicResource BorderDefault}" />

                        <Grid ColumnDefinitions="*,12,Auto" HorizontalAlignment="Stretch" MinHeight="48">
                            <TextBlock Text="{DynamicResource Settings_WireGuardDriver}" Classes="BodyStrong" />
                            <TextBlock Grid.Column="2"
                                       Text="{Binding DriverVersionDisplay}" 
                                       Classes="Body"
                                       HorizontalAlignment="Right" />
                        </Grid>

                        <Border Height="1" Background="{DynamicResource BorderDefault}" />

                        <Button Classes="Secondary" HorizontalAlignment="Left"
                                Command="{Binding CheckForUpdatesCommand}">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <PathIcon Data="M21 10.12h-6.78l2.74-2.82c-2.73-2.7-7.15-2.8-9.88-.1-2.73 2.71-2.73 7.08 0 9.79s7.15 2.71 9.88 0C18.32 15.65 19 14.08 19 12.1h2c0 1.98-.88 4.55-2.64 6.29-3.51 3.48-9.21 3.48-12.72 0-3.5-3.47-3.53-9.11-.02-12.58s9.14-3.47 12.65 0L21 3v7.12z"
                                          Width="16" Height="16" />
                                <TextBlock Text="{DynamicResource Settings_CheckForUpdates}" />
                            </StackPanel>
                        </Button>

                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- Save Button -->
            <Button Classes="Primary" 
                    HorizontalAlignment="Right"
                    Command="{Binding SaveSettingsCommand}">
                <TextBlock Text="{DynamicResource Settings_SaveChanges}" />
            </Button>

        </StackPanel>
    </ScrollViewer>

</UserControl>
